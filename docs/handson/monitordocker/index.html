





    




<!DOCTYPE HTML>

<html>
    <head>
        
            <title>Monitoring Docker - Datadog Training Site</title>
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="generator" content="Hugo 0.25.1" />
        


        
        
            <meta name="description" content="Add Docker to the Monitoring mix">
        

        

  <meta name="twitter:card" content="summary"/>



<meta name="twitter:text:title" content="Monitoring Docker"/>
<meta name="twitter:title" content="Monitoring Docker"/>
<meta name="twitter:description" content="Add Docker to the Monitoring mix"/>
<meta name="twitter:site" content="@datadoghq"/>

        <meta property="og:title" content="Monitoring Docker" />
<meta property="og:description" content="Add Docker to the Monitoring mix" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://datadog.github.io/summit-training-session/handson/monitordocker/" />



<meta property="article:published_time" content="2016-10-17T08:47:25-04:00"/>
<meta property="article:modified_time" content="2016-10-17T08:47:25-04:00"/>











        
<meta itemprop="name" content="Monitoring Docker">
<meta itemprop="description" content="Add Docker to the Monitoring mix">


<meta itemprop="dateModified" content="2016-10-17T08:47:25-04:00" />
<meta itemprop="wordCount" content="398">



<meta itemprop="keywords" content="" />

        

        

        
        
            
        

        
        
            <link rel="stylesheet" href="https://datadog.github.io/summit-training-session//css/google-font.css" />
            <link rel="stylesheet" href="https://datadog.github.io/summit-training-session//css/font-awesome.min.css" />
            <link rel="stylesheet" href="https://datadog.github.io/summit-training-session//css/main.css" />
            <link rel="stylesheet" href="https://datadog.github.io/summit-training-session/css/add-on.css" />
            <link rel="stylesheet" href="https://datadog.github.io/summit-training-session//css/monokai-sublime.css">
        

        

        
        
        
            
        

    </head>
    <body>

        
        <div id="wrapper">

<style type="text/css">

  #hainstruction {
    height: 100%;
    overflow: auto;
    box-sizing: border-box;
    padding: 0.4em;
  }
  #webframe {
        float: right;
    width: 70%;
    height: 100%;
    overflow: auto;
    box-sizing: border-box;
    background-color: grey;
    padding: 2px;
  }

</style>
    
<header id="header">
    
        <h2><a href="https://datadog.github.io/summit-training-session/">Session Agenda</i></a></h2>
    

    <nav class="links">
        <ul>
            
                <li>
                    <a href="/summit-training-session/preso/">
                        
                            <i class="fa fa-tv">&nbsp;</i>Presentations
                    </a>
                </li>
            
                <li>
                    <a href="/summit-training-session/notes/">
                        
                            <i class="fa fa-file-text-o">&nbsp;</i>Notes
                    </a>
                </li>
            
                <li>
                    <a href="/summit-training-session/handson/">
                        
                            <i class="fa fa-hand-stop-o">&nbsp;</i>Hands On
                    </a>
                </li>
            
                <li>
                    <a href="/summit-training-session/about/">
                        
                            <i class="fa fa-question-circle">&nbsp;</i>About
                    </a>
                </li>
            
        </ul>
    </nav>
    <nav class="main">
        <ul>
            
            <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <form id="search" method="get" action="//google.com/search">
                    <input type="text" name="q" placeholder="Search" />
                    <input type="hidden" name="q" value="site:https://datadog.github.io/summit-training-session/">
                </form>
            </li>
            <li class="menu">
                <a class="fa-bars" href="#menu">Menu</a>
            </li>
        </ul>
    </nav>
</header>


<section id="menu">

    
        <section>
            <form class="search" method="get" action="//google.com/search">
                <input type="text" name="q" placeholder="Search" />
                <input type="hidden" name="q" value="site:https://datadog.github.io/summit-training-session/">
            </form>
        </section>

    
        <section>
            <ul class="links">
                
                    <li>
                        <a href="/summit-training-session/preso/">
                            <h3>
                                
                                    <i class="fa fa-tv">&nbsp;</i>
                                
                                Presentations
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/summit-training-session/notes/">
                            <h3>
                                
                                    <i class="fa fa-file-text-o">&nbsp;</i>
                                
                                Notes
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/summit-training-session/handson/">
                            <h3>
                                
                                    <i class="fa fa-hand-stop-o">&nbsp;</i>
                                
                                Hands On
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/summit-training-session/about/">
                            <h3>
                                
                                    <i class="fa fa-question-circle">&nbsp;</i>
                                
                                About
                            </h3>
                        </a>
                    </li>
                
            </ul>
        </section>

    


    
        
</section>



      
    <div id="main">
    <h1>Monitoring Docker (Hands On Instructions)</h1>
    <p>This exercise requires Docker to be installed somewhere. You could do this on your laptop, on the Vagrant box you created earlier, or on any machine you can remotely access. If installing for the first time on your laptop, see <a href="https://www.docker.com/products/overview">https://www.docker.com/products/overview</a> for links to the installers for your platform.</p>

<ol>
<li>Navigate to the Agent Installation page in the Datadog application (<a href="https://app.datadoghq.com/account/settings#agent/docker">https://app.datadoghq.com/account/settings#agent/docker</a>).</li>
<li>Select <strong>Docker</strong> and copy the first command. Run it where ever you have Docker installed.</li>
<li>You now have the Datadog agent running on your Docker machine.</li>
<li>Run <code>docker exec -it dd-agent bash</code> to login to a bash shell on that container.</li>
<li>You can now run any of the Datadog commands you have on Linux. For instance, run <code>/etc/init.d/datadog-agent info</code>.</li>
<li>You can try other commands, or type <code>exit</code> to return to your host machine.</li>
<li>Start a Redis container by running the following command: <code>docker run --name ad-redis redis</code>.</li>
<li>Run the Datadog Agent Info command. Also run the Agent&rsquo;s configcheck command. Is Redis being monitored?</li>

<li><p>Create a new file called <code>Dockerfile</code> in a new directory called <code>redisdocker</code>. Edit the file and add a single line</p>

<pre><code>FROM redis
</code></pre></li>

<li><p>Build the new image using the following command: <code>docker build -t redisdocker .</code></p></li>

<li><p>Run the redisdocker image using the command: <code>docker run --name dd-redis -d redisdocker</code>. The Redis docker container based on our modified image is now running.</p></li>

<li><p>Run the Datadog Agent Info command again. Is the new database being monitored?</p></li>
</ol>

<p>Let&rsquo;s switch over to using docker-compose.</p>

<ol>
<li><p>Create a docker-compose.yaml file with the following contents:</p>

<pre><code>version: &quot;3&quot;
networks:
  main:

services:
  datadog:
    image: datadog/docker-dd-agent
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /proc:/host/proc:ro
      - /sys/fs/cgroup:/host/sys/fs/cgroup:ro
    environment:
      - API_KEY
      - SD_BACKEND=docker
    networks:
      - main

  frontendredis:
    image: redis
    networks:
      - main

  backendredis:
    build: .
    networks:
      - main
</code></pre></li>

<li><p>Run the datadog info command (<code>docker-compose exec datadog /etc/init.d/datadog-agent info</code>). How many redis instances are being monitored.</p></li>

<li><p>Modify the backendredis service to show the following:</p>

<pre><code>backendredis:
    build: .
    networks:
      - main
    labels:
      com.datadoghq.ad.check_names: '[&quot;redisdb&quot;]'
      com.datadoghq.ad.init_configs: '[{}]'
      com.datadoghq.ad.instances: '[{&quot;host&quot;:&quot;%%host%%&quot;, &quot;port&quot;: &quot;%%port%%&quot;}]'
</code></pre></li>

<li><p>Stop and remove the containers then run <code>docker-compose up</code> again.</p></li>

<li><p>Run the Datadog Agent Info command again, how many instances are being monitored?</p></li>
</ol>

<p>Let&rsquo;s create the same environment in Kubernetes.</p>

<p>Once you have the Redis container running, choose another local integration from the <a href="http://docs.datadoghq.com/integrations/">Integration documentation</a>. Start the container using an image found on the <a href="https://hub.docker.com/">Docker Hub</a> and create a configuration. At the end of this session, lets talk about how you did it.</p>

    
    <a href="https://datadog.github.io/summit-training-session/preso/monitordocker">Presentation</a> | <a href="https://datadog.github.io/summit-training-session/notes/monitordocker">Notes</a>

    </div>

<section id="sidebar">

    
        <section id="intro">
        
            
            
                
                    <img src="https://datadog.github.io/summit-training-session/images/ddlogo.png" class="intro-circle" width="200px" alt="Datadog" />
                
            
            
                <header>
                    <h2>Datadog Summit</h2>
                    <p>Everything you need to follow along with the training at the Datadog Summit <i class='fa fa-hand-peace-o'></i></p>
                </header>
            
   
        </section>



    
    
    

    
        

    
        <section id="footer">
            <ul class="icons">
                
                
                    
<li><a href="//github.com/datadog" target="_blank" title="GitHub" class="fa fa-github"></a></li>

















































<li><a href="//twitter.com/datadoghq" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>




                
            </ul>

            <p class="copyright">&copy; Datadog Training Site. Design: <a href="http://html5up.net" target="_blank">HTML5 UP</a>. Ported by <a href="//github.com/jpescador" target="_blank">Julio Pescador</a>. Powered by <a href="//gohugo.io" target="_blank">Hugo</a></p>
        </section>

</section>
    
            </div>
        <a id="back-to-top" href="#" class="fa fa-arrow-up fa-border fa-2x"></a>
        

        
        
            
        

        
        
            <script src="https://datadog.github.io/summit-training-session//js/jquery.min.js"></script>
            <script src="https://datadog.github.io/summit-training-session//js/skel.min.js"></script>
            <script src="https://datadog.github.io/summit-training-session//js/util.js"></script>
            <script src="https://datadog.github.io/summit-training-session//js/main.js"></script>
            <script src="https://datadog.github.io/summit-training-session//js/backToTop.js"></script>
            <script src="https://datadog.github.io/summit-training-session//js/highlight.pack.js"></script>
        
        
        
            
            <script>hljs.initHighlightingOnLoad();</script>
            
    </body>
</html>

